{"code":"!function(e){var t={};function l(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,l),r.l=!0,r.exports}l.m=e,l.c=t,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},l.r=function(e){Object.defineProperty(e,\"__esModule\",{value:!0})},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,\"a\",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p=\"\",l(l.s=0)}([function(e,t){let l,n;var r;function a(e,t){for(var l=$(\"#grid\").jqxGrid(\"selectedrowindexes\"),r=new Array,a=0;a<l.length;a++)r[a]=n[l[a]];return console.log(r),t(r),r}window.IQc={entity:\"x\",ENTITIES:{x:\"x\"}},$(\"#file-input\").on(\"change\",e=>{(r=document.getElementById(\"file-input\").files[0],XlsxPopulate.fromDataAsync(r)).then(e=>{let t=(l=e).sheet(\"students\")._rows.length-2;n=new Array(t);var r=new Array;for(let l=2;l<=t+1;l++){n[l-2]={date:e.sheet(\"students\").cell(\"BA\"+l).value(),num_prot:e.sheet(\"students\").cell(\"BB\"+l).value(),spec_numb:e.sheet(\"students\").cell(\"AQ\"+l).value(),spec_nazv:e.sheet(\"students\").cell(\"AR\"+l).value(),name_IP:e.sheet(\"students\").cell(\"C\"+l).value(),mark:e.sheet(\"students\").cell(\"AD\"+l).value(),letter:e.sheet(\"students\").cell(\"AB\"+l).value(),number:e.sheet(\"students\").cell(\"AC\"+l).value(),name_DP:e.sheet(\"students\").cell(\"I\"+l).value(),obrazov:e.sheet(\"students\").cell(\"K\"+l).value(),otlichie:e.sheet(\"students\").cell(\"BH\"+l).value(),text:e.sheet(\"students\").cell(\"BK\"+l).value(),recenzent:e.sheet(\"students\").cell(\"AH\"+l).value(),tema:e.sheet(\"students\").cell(\"L\"+l).value(),magister:e.sheet(\"students\").cell(\"AT\"+l).value(),profil:e.sheet(\"students\").cell(\"AS\"+l).value(),ruk_F:e.sheet(\"students\").cell(\"M\"+l).value(),ruk_IO:e.sheet(\"students\").cell(\"N\"+l).value(),ruk_F_RP:e.sheet(\"students\").cell(\"P\"+l).value(),secretar:e.sheet(\"students\").cell(\"AU\"+l).value()};var a={};a.name_IP=n[l-2].name_IP,a.spec_numb=n[l-2].spec_numb,a.spec_nazv=n[l-2].spec_nazv,a.tema=n[l-2].tema,a.ruk_F=n[l-2].ruk_F,a.letter=n[l-2].letter,a.recenzent=n[l-2].recenzent,a.secretar=n[l-2].secretar,a.date=n[l-2].date,r[l-2]=a}var s={localdata:r,datatype:\"array\"},u=new $.jqx.dataAdapter(s,{loadComplete:function(e){},loadError:function(e,t,l){}});$(\"#grid\").jqxGrid({source:u,theme:\"energyblue\",width:\"100%\",height:\"100%\",sortable:!0,filterable:!0,showfilterrow:!0,selectionmode:\"multiplerows\",columns:[{text:\"ФИО\",datafield:\"name_IP\",width:200},{text:\"Тема диплома\",datafield:\"tema\",width:270},{text:\"Номер спец.\",datafield:\"spec_numb\",width:80},{text:\"Назв. спец.\",datafield:\"spec_nazv\",width:200},{text:\"Руководитель\",datafield:\"ruk_F\",width:120},{text:\"Рецензент\",datafield:\"recenzent\",width:140},{text:\"Секретарь\",datafield:\"secretar\",width:140},{text:\"Дата сдачи\",datafield:\"date\",width:100}]})})}),$(\"#submit_button\").jqxButton({theme:\"energyblue\",height:40}),$(\"#extract_button\").jqxButton({theme:\"energyblue\",height:40}),$(\"#selectAll\").jqxToggleButton({theme:\"energyblue\",height:40}),$(\"#deleterowbutton\").jqxToggleButton({theme:\"energyblue\",height:40}),$(\"#form\").submit(e=>{e.preventDefault(),a($(\"#form\"),e=>{$.ajax({type:\"POST\",url:\"/getWordProtokol\",data:JSON.stringify(e),success:e=>{e.forEach(e=>window.open(e,\"_blank\"))}})})}),$(\"#extract_button\").click(e=>{e.preventDefault(),a($(\"#form\"),e=>{$.ajax({type:\"POST\",url:\"/getWordExtract\",data:JSON.stringify(e),success:e=>{e.forEach(e=>window.open(e,\"_blank\"))}})})}),$(\"#selectAll\").on(\"click\",function(){$(\"#selectAll\").jqxToggleButton(\"toggled\")?$(\"#grid\").jqxGrid(\"selectallrows\"):$(\"#grid\").jqxGrid(\"clearselection\")}),$(\"#deleterowbutton\").on(\"click\",function(){var e=$(\"#grid\").jqxGrid(\"getselectedrowindex\"),t=$(\"#grid\").jqxGrid(\"getdatainformation\").rowscount;if(e>=0&&e<t){var l=$(\"#grid\").jqxGrid(\"getrowid\",e);$(\"#grid\").jqxGrid(\"deleterow\",l)}})}]);","extractedComments":[]}